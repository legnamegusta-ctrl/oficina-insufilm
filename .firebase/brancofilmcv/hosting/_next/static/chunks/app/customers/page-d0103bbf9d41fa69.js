(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[374],{4070:function(e,t,a){Promise.resolve().then(a.bind(a,514))},514:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return S}});var r=a(7437),i=a(2265),s=a(1221),n=a(7484),l=a(9501),o=a(5701),d=a(7119),c=a(2869),u=a(5186),m=a(6815),v=a(6818),f=a(6070),x=a(5613),h=a(1817);let p=d.Ry({name:d.Z_().min(1,"Nome \xe9 obrigat\xf3rio"),phone:d.Z_().optional(),email:d.Z_().email("Email inv\xe1lido").optional().or(d.i0("")),notes:d.Z_().optional()});function b(e){let{customer:t,onSubmit:a,onCancel:i,loading:s=!1}=e,{register:n,handleSubmit:d,formState:{errors:b}}=(0,l.cI)({resolver:(0,o.F)(p),defaultValues:{name:(null==t?void 0:t.name)||"",phone:(null==t?void 0:t.phone)||"",email:(null==t?void 0:t.email)||"",notes:(null==t?void 0:t.notes)||""}}),j=async e=>{try{await a(e)}catch(e){console.error("Error submitting form:",e)}};return(0,r.jsxs)(f.Zb,{className:"w-full max-w-2xl mx-auto",children:[(0,r.jsxs)(f.Ol,{children:[(0,r.jsx)(f.ll,{children:t?"Editar Cliente":"Novo Cliente"}),(0,r.jsx)(f.SZ,{children:t?"Atualize as informa\xe7\xf5es do cliente":"Preencha os dados do novo cliente"})]}),(0,r.jsx)(f.aY,{children:(0,r.jsxs)("form",{onSubmit:d(j),className:"space-y-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(m._,{htmlFor:"name",children:"Nome *"}),(0,r.jsx)(u.I,{id:"name",...n("name"),disabled:s}),b.name&&(0,r.jsx)(x.bZ,{variant:"destructive",children:(0,r.jsx)(x.X,{children:b.name.message})})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(m._,{htmlFor:"phone",children:"Telefone"}),(0,r.jsx)(u.I,{id:"phone",...n("phone"),disabled:s,placeholder:"(11) 99999-9999"}),b.phone&&(0,r.jsx)(x.bZ,{variant:"destructive",children:(0,r.jsx)(x.X,{children:b.phone.message})})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(m._,{htmlFor:"email",children:"Email"}),(0,r.jsx)(u.I,{id:"email",type:"email",...n("email"),disabled:s,placeholder:"cliente@email.com"}),b.email&&(0,r.jsx)(x.bZ,{variant:"destructive",children:(0,r.jsx)(x.X,{children:b.email.message})})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(m._,{htmlFor:"notes",children:"Observa\xe7\xf5es"}),(0,r.jsx)(v.g,{id:"notes",...n("notes"),disabled:s,placeholder:"Informa\xe7\xf5es adicionais sobre o cliente...",rows:3}),b.notes&&(0,r.jsx)(x.bZ,{variant:"destructive",children:(0,r.jsx)(x.X,{children:b.notes.message})})]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-2 pt-4",children:[(0,r.jsx)(c.z,{type:"button",variant:"outline",onClick:i,disabled:s,children:"Cancelar"}),(0,r.jsxs)(c.z,{type:"submit",disabled:s,children:[s&&(0,r.jsx)(h.Z,{className:"mr-2 h-4 w-4 animate-spin"}),t?"Atualizar":"Criar"," Cliente"]})]})]})})]})}let j=d.Ry({plate:d.Z_().min(1,"Placa \xe9 obrigat\xf3ria"),model:d.Z_().min(1,"Modelo \xe9 obrigat\xf3rio"),year:d.Rx().min(1900,"Ano inv\xe1lido").max(new Date().getFullYear()+1,"Ano inv\xe1lido").optional(),color:d.Z_().optional()});function g(e){let{vehicle:t,customerId:a,customerName:i,onSubmit:s,onCancel:n,loading:d=!1}=e,{register:v,handleSubmit:p,formState:{errors:b}}=(0,l.cI)({resolver:(0,o.F)(j),defaultValues:{plate:(null==t?void 0:t.plate)||"",model:(null==t?void 0:t.model)||"",year:(null==t?void 0:t.year)||void 0,color:(null==t?void 0:t.color)||""}}),g=async e=>{try{await s({...e,customerId:a})}catch(e){console.error("Error submitting form:",e)}};return(0,r.jsxs)(f.Zb,{className:"w-full max-w-2xl mx-auto",children:[(0,r.jsxs)(f.Ol,{children:[(0,r.jsx)(f.ll,{children:t?"Editar Ve\xedculo":"Novo Ve\xedculo"}),(0,r.jsx)(f.SZ,{children:t?"Atualize as informa\xe7\xf5es do ve\xedculo":"Adicionar ve\xedculo para ".concat(i)})]}),(0,r.jsx)(f.aY,{children:(0,r.jsxs)("form",{onSubmit:p(g),className:"space-y-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(m._,{htmlFor:"plate",children:"Placa *"}),(0,r.jsx)(u.I,{id:"plate",...v("plate"),disabled:d,placeholder:"ABC-1234",style:{textTransform:"uppercase"}}),b.plate&&(0,r.jsx)(x.bZ,{variant:"destructive",children:(0,r.jsx)(x.X,{children:b.plate.message})})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(m._,{htmlFor:"model",children:"Modelo *"}),(0,r.jsx)(u.I,{id:"model",...v("model"),disabled:d,placeholder:"Honda Civic, Toyota Corolla..."}),b.model&&(0,r.jsx)(x.bZ,{variant:"destructive",children:(0,r.jsx)(x.X,{children:b.model.message})})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(m._,{htmlFor:"year",children:"Ano"}),(0,r.jsx)(u.I,{id:"year",type:"number",...v("year",{valueAsNumber:!0}),disabled:d,placeholder:"2020"}),b.year&&(0,r.jsx)(x.bZ,{variant:"destructive",children:(0,r.jsx)(x.X,{children:b.year.message})})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(m._,{htmlFor:"color",children:"Cor"}),(0,r.jsx)(u.I,{id:"color",...v("color"),disabled:d,placeholder:"Branco, Preto, Prata..."}),b.color&&(0,r.jsx)(x.bZ,{variant:"destructive",children:(0,r.jsx)(x.X,{children:b.color.message})})]})]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-2 pt-4",children:[(0,r.jsx)(c.z,{type:"button",variant:"outline",onClick:n,disabled:d,children:"Cancelar"}),(0,r.jsxs)(c.z,{type:"submit",disabled:d,children:[d&&(0,r.jsx)(h.Z,{className:"mr-2 h-4 w-4 animate-spin"}),t?"Atualizar":"Adicionar"," Ve\xedculo"]})]})]})})]})}var y=a(5974),N=a(6110),w=a(7099),C=a(8356),E=a(1731),k=a(5153);function S(){var e;let t;let[a,l]=(0,i.useState)([]),[o,d]=(0,i.useState)([]),[c,u]=(0,i.useState)(!0),[m,v]=(0,i.useState)(null),[f,x]=(0,i.useState)(null),[h,p]=(0,i.useState)(!1),[j,S]=(0,i.useState)(!1),[V,Z]=(0,i.useState)(!1),[A,_]=(0,i.useState)(null),[I,T]=(0,i.useState)(!1),{toast:R}=(0,k.pm)();(0,i.useEffect)(()=>{P()},[]);let P=async()=>{try{u(!0);let[e,t]=await Promise.all([E.YN.getAll(),E.GL.getAll()]);l(e),d(t)}catch(e){console.error("Error loading data:",e),R({title:"Erro",description:"Erro ao carregar dados",variant:"destructive"})}finally{u(!1)}},z=async e=>{try{T(!0),m?(await E.YN.update(m.id,e),R({title:"Sucesso",description:"Cliente atualizado com sucesso"})):(await E.YN.create(e),R({title:"Sucesso",description:"Cliente criado com sucesso"})),await P(),p(!1),v(null)}catch(e){console.error("Error saving customer:",e),R({title:"Erro",description:"Erro ao salvar cliente",variant:"destructive"})}finally{T(!1)}},F=async e=>{try{T(!0),f?(await E.GL.update(f.id,e),R({title:"Sucesso",description:"Ve\xedculo atualizado com sucesso"})):(await E.GL.create(e),R({title:"Sucesso",description:"Ve\xedculo adicionado com sucesso"})),await P(),S(!1),x(null)}catch(e){console.error("Error saving vehicle:",e),R({title:"Erro",description:"Erro ao salvar ve\xedculo",variant:"destructive"})}finally{T(!1)}},D=async()=>{if(A)try{"customer"===A.type?(await E.YN.delete(A.item.id),R({title:"Sucesso",description:"Cliente exclu\xeddo com sucesso"})):(await E.GL.delete(A.item.id),R({title:"Sucesso",description:"Ve\xedculo exclu\xeddo com sucesso"})),await P()}catch(e){console.error("Error deleting item:",e),R({title:"Erro",description:"Erro ao excluir item",variant:"destructive"})}finally{Z(!1),_(null)}};return(0,r.jsx)(s.L,{requiredRoles:["admin","atendente"],children:(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Clientes & Ve\xedculos"}),(0,r.jsx)("p",{className:"text-muted-foreground",children:"Gerencie clientes e seus ve\xedculos"})]}),(0,r.jsxs)(C.mQ,{defaultValue:"customers",className:"space-y-4",children:[(0,r.jsxs)(C.dr,{children:[(0,r.jsx)(C.SP,{value:"customers",children:"Clientes"}),(0,r.jsx)(C.SP,{value:"vehicles",children:"Ve\xedculos"})]}),(0,r.jsx)(C.nU,{value:"customers",children:(0,r.jsx)(n.w,{data:a,columns:[{key:"name",title:"Nome",sortable:!0},{key:"phone",title:"Telefone",render:e=>e||"-"},{key:"email",title:"Email",render:e=>e||"-"},{key:"vehicles",title:"Ve\xedculos",render:(e,t)=>{let a=o.filter(e=>e.customerId===t.id);return(0,r.jsxs)(y.C,{variant:"secondary",children:[a.length," ",1===a.length?"ve\xedculo":"ve\xedculos"]})}},{key:"createdAt",title:"Cadastrado em",render:e=>(null==e?void 0:e.toDate)?e.toDate().toLocaleDateString("pt-BR"):"-"}],title:"Lista de Clientes",description:"Todos os clientes cadastrados no sistema",searchPlaceholder:"Buscar por nome, telefone ou email...",onAdd:()=>p(!0),onEdit:e=>{v(e),p(!0)},onDelete:e=>{_({type:"customer",item:e}),Z(!0)},loading:c,addButtonText:"Novo Cliente"})}),(0,r.jsx)(C.nU,{value:"vehicles",children:(0,r.jsx)(n.w,{data:o,columns:[{key:"plate",title:"Placa",sortable:!0},{key:"model",title:"Modelo",sortable:!0},{key:"year",title:"Ano",render:e=>e||"-"},{key:"color",title:"Cor",render:e=>e||"-"},{key:"customer",title:"Cliente",render:(e,t)=>{let r=a.find(e=>e.id===t.customerId);return(null==r?void 0:r.name)||"Cliente n\xe3o encontrado"}}],title:"Lista de Ve\xedculos",description:"Todos os ve\xedculos cadastrados no sistema",searchPlaceholder:"Buscar por placa, modelo ou cliente...",onAdd:()=>{if(0===a.length){R({title:"Aten\xe7\xe3o",description:"\xc9 necess\xe1rio ter pelo menos um cliente cadastrado para adicionar ve\xedculos",variant:"destructive"});return}S(!0)},onEdit:e=>{x(e),S(!0)},onDelete:e=>{_({type:"vehicle",item:e}),Z(!0)},loading:c,addButtonText:"Novo Ve\xedculo"})})]}),(0,r.jsx)(N.Vq,{open:h,onOpenChange:p,children:(0,r.jsx)(N.cZ,{className:"max-w-2xl",children:(0,r.jsx)(b,{customer:m||void 0,onSubmit:z,onCancel:()=>{p(!1),v(null)},loading:I})})}),(0,r.jsx)(N.Vq,{open:j,onOpenChange:S,children:(0,r.jsx)(N.cZ,{className:"max-w-2xl",children:a.length>0&&(0,r.jsx)(g,{vehicle:f||void 0,customerId:(null==f?void 0:f.customerId)||a[0].id,customerName:f?(null===(t=f.customerId,e=a.find(e=>e.id===t))||void 0===e?void 0:e.name)||"Cliente":a[0].name,onSubmit:F,onCancel:()=>{S(!1),x(null)},loading:I})})}),(0,r.jsx)(w.aR,{open:V,onOpenChange:Z,children:(0,r.jsxs)(w._T,{children:[(0,r.jsxs)(w.fY,{children:[(0,r.jsx)(w.f$,{children:"Confirmar Exclus\xe3o"}),(0,r.jsx)(w.yT,{children:(null==A?void 0:A.type)==="customer"?"Tem certeza que deseja excluir este cliente? Todos os ve\xedculos associados tamb\xe9m ser\xe3o exclu\xeddos. Esta a\xe7\xe3o n\xe3o pode ser desfeita.":"Tem certeza que deseja excluir este ve\xedculo? Esta a\xe7\xe3o n\xe3o pode ser desfeita."})]}),(0,r.jsxs)(w.xo,{children:[(0,r.jsx)(w.le,{children:"Cancelar"}),(0,r.jsx)(w.OL,{onClick:D,className:"bg-destructive text-destructive-foreground",children:"Excluir"})]})]})})]})})}},5613:function(e,t,a){"use strict";a.d(t,{X:function(){return d},bZ:function(){return o}});var r=a(7437),i=a(2265),s=a(535),n=a(4508);let l=(0,s.j)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),o=i.forwardRef((e,t)=>{let{className:a,variant:i,...s}=e;return(0,r.jsx)("div",{ref:t,role:"alert",className:(0,n.cn)(l({variant:i}),a),...s})});o.displayName="Alert",i.forwardRef((e,t)=>{let{className:a,...i}=e;return(0,r.jsx)("h5",{ref:t,className:(0,n.cn)("mb-1 font-medium leading-none tracking-tight",a),...i})}).displayName="AlertTitle";let d=i.forwardRef((e,t)=>{let{className:a,...i}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("text-sm [&_p]:leading-relaxed",a),...i})});d.displayName="AlertDescription"},5974:function(e,t,a){"use strict";a.d(t,{C:function(){return l}});var r=a(7437);a(2265);var i=a(535),s=a(4508);let n=(0,i.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function l(e){let{className:t,variant:a,...i}=e;return(0,r.jsx)("div",{className:(0,s.cn)(n({variant:a}),t),...i})}},8356:function(e,t,a){"use strict";a.d(t,{mQ:function(){return Z},nU:function(){return I},dr:function(){return A},SP:function(){return _}});var r=a(7437),i=a(2265),s=a(6741),n=a(3966),l=a(1353),o=a(1599),d=a(6840),c=a(9114),u=a(886),m=a(9255),v="Tabs",[f,x]=(0,n.b)(v,[l.Pc]),h=(0,l.Pc)(),[p,b]=f(v),j=i.forwardRef((e,t)=>{let{__scopeTabs:a,value:i,onValueChange:s,defaultValue:n,orientation:l="horizontal",dir:o,activationMode:v="automatic",...f}=e,x=(0,c.gm)(o),[h,b]=(0,u.T)({prop:i,onChange:s,defaultProp:n});return(0,r.jsx)(p,{scope:a,baseId:(0,m.M)(),value:h,onValueChange:b,orientation:l,dir:x,activationMode:v,children:(0,r.jsx)(d.WV.div,{dir:x,"data-orientation":l,...f,ref:t})})});j.displayName=v;var g="TabsList",y=i.forwardRef((e,t)=>{let{__scopeTabs:a,loop:i=!0,...s}=e,n=b(g,a),o=h(a);return(0,r.jsx)(l.fC,{asChild:!0,...o,orientation:n.orientation,dir:n.dir,loop:i,children:(0,r.jsx)(d.WV.div,{role:"tablist","aria-orientation":n.orientation,...s,ref:t})})});y.displayName=g;var N="TabsTrigger",w=i.forwardRef((e,t)=>{let{__scopeTabs:a,value:i,disabled:n=!1,...o}=e,c=b(N,a),u=h(a),m=k(c.baseId,i),v=S(c.baseId,i),f=i===c.value;return(0,r.jsx)(l.ck,{asChild:!0,...u,focusable:!n,active:f,children:(0,r.jsx)(d.WV.button,{type:"button",role:"tab","aria-selected":f,"aria-controls":v,"data-state":f?"active":"inactive","data-disabled":n?"":void 0,disabled:n,id:m,...o,ref:t,onMouseDown:(0,s.M)(e.onMouseDown,e=>{n||0!==e.button||!1!==e.ctrlKey?e.preventDefault():c.onValueChange(i)}),onKeyDown:(0,s.M)(e.onKeyDown,e=>{[" ","Enter"].includes(e.key)&&c.onValueChange(i)}),onFocus:(0,s.M)(e.onFocus,()=>{let e="manual"!==c.activationMode;f||n||!e||c.onValueChange(i)})})})});w.displayName=N;var C="TabsContent",E=i.forwardRef((e,t)=>{let{__scopeTabs:a,value:s,forceMount:n,children:l,...c}=e,u=b(C,a),m=k(u.baseId,s),v=S(u.baseId,s),f=s===u.value,x=i.useRef(f);return i.useEffect(()=>{let e=requestAnimationFrame(()=>x.current=!1);return()=>cancelAnimationFrame(e)},[]),(0,r.jsx)(o.z,{present:n||f,children:a=>{let{present:i}=a;return(0,r.jsx)(d.WV.div,{"data-state":f?"active":"inactive","data-orientation":u.orientation,role:"tabpanel","aria-labelledby":m,hidden:!i,id:v,tabIndex:0,...c,ref:t,style:{...e.style,animationDuration:x.current?"0s":void 0},children:i&&l})}})});function k(e,t){return"".concat(e,"-trigger-").concat(t)}function S(e,t){return"".concat(e,"-content-").concat(t)}E.displayName=C;var V=a(4508);let Z=j,A=i.forwardRef((e,t)=>{let{className:a,...i}=e;return(0,r.jsx)(y,{ref:t,className:(0,V.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",a),...i})});A.displayName=y.displayName;let _=i.forwardRef((e,t)=>{let{className:a,...i}=e;return(0,r.jsx)(w,{ref:t,className:(0,V.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",a),...i})});_.displayName=w.displayName;let I=i.forwardRef((e,t)=>{let{className:a,...i}=e;return(0,r.jsx)(E,{ref:t,className:(0,V.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",a),...i})});I.displayName=E.displayName},6818:function(e,t,a){"use strict";a.d(t,{g:function(){return n}});var r=a(7437),i=a(2265),s=a(4508);let n=i.forwardRef((e,t)=>{let{className:a,...i}=e;return(0,r.jsx)("textarea",{className:(0,s.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:t,...i})});n.displayName="Textarea"},1817:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9205).Z)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])}},function(e){e.O(0,[609,15,365,852,905,593,641,302,971,117,744],function(){return e(e.s=4070)}),_N_E=e.O()}]);