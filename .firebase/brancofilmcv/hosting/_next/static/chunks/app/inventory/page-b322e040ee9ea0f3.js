(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[268],{3768:function(e,t,r){Promise.resolve().then(r.bind(r,3506))},3506:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return Z}});var s=r(7437),a=r(2265),l=r(1221),o=r(7484),i=r(9501),n=r(5701),d=r(7119),c=r(2869),u=r(5186),m=r(6815),x=r(6070),h=r(5613),f=r(1817);let v=d.Ry({tone:d.Z_().min(1,"Tonalidade \xe9 obrigat\xf3ria"),width_mm:d.Rx().min(1,"Largura deve ser maior que zero"),length_m_total:d.Rx().min(0,"Comprimento deve ser maior ou igual a zero"),cost:d.Rx().min(0,"Custo deve ser maior ou igual a zero").optional(),supplier:d.Z_().optional(),lot:d.Z_().optional(),lowStockAlertAt_m:d.Rx().min(0,"Alerta de estoque deve ser maior ou igual a zero").optional()});function p(e){let{roll:t,onSubmit:r,onCancel:a,loading:l=!1,isRestock:o=!1}=e,{register:d,handleSubmit:p,formState:{errors:g}}=(0,i.cI)({resolver:(0,n.F)(v),defaultValues:{tone:(null==t?void 0:t.tone)||"",width_mm:(null==t?void 0:t.width_mm)||1520,length_m_total:o?0:(null==t?void 0:t.length_m_total)||0,cost:(null==t?void 0:t.cost)||0,supplier:(null==t?void 0:t.supplier)||"",lot:(null==t?void 0:t.lot)||"",lowStockAlertAt_m:(null==t?void 0:t.lowStockAlertAt_m)||10}}),j=async e=>{try{await r(e)}catch(e){console.error("Error submitting form:",e)}};return(0,s.jsxs)(x.Zb,{className:"w-full max-w-2xl mx-auto",children:[(0,s.jsxs)(x.Ol,{children:[(0,s.jsx)(x.ll,{children:o?"Reabastecer Estoque":t?"Editar Rolo":"Novo Rolo"}),(0,s.jsx)(x.SZ,{children:o?"Adicionar metros ao rolo existente":t?"Atualize as informa\xe7\xf5es do rolo":"Preencha os dados do novo rolo de insufilm"})]}),(0,s.jsx)(x.aY,{children:(0,s.jsxs)("form",{onSubmit:p(j),className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(m._,{htmlFor:"tone",children:"Tonalidade *"}),(0,s.jsx)(u.I,{id:"tone",...d("tone"),disabled:l||o&&!!t,placeholder:"20%, 35%, 50%, 70%"}),g.tone&&(0,s.jsx)(h.bZ,{variant:"destructive",children:(0,s.jsx)(h.X,{children:g.tone.message})})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(m._,{htmlFor:"width_mm",children:"Largura (mm) *"}),(0,s.jsx)(u.I,{id:"width_mm",type:"number",...d("width_mm",{valueAsNumber:!0}),disabled:l||o&&!!t,placeholder:"1520"}),g.width_mm&&(0,s.jsx)(h.bZ,{variant:"destructive",children:(0,s.jsx)(h.X,{children:g.width_mm.message})})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(m._,{htmlFor:"length_m_total",children:o?"Metros a Adicionar *":"Comprimento Total (m) *"}),(0,s.jsx)(u.I,{id:"length_m_total",type:"number",step:"0.1",...d("length_m_total",{valueAsNumber:!0}),disabled:l,placeholder:o?"30.5":"100.0"}),g.length_m_total&&(0,s.jsx)(h.bZ,{variant:"destructive",children:(0,s.jsx)(h.X,{children:g.length_m_total.message})})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(m._,{htmlFor:"cost",children:"Custo (R$)"}),(0,s.jsx)(u.I,{id:"cost",type:"number",step:"0.01",...d("cost",{valueAsNumber:!0}),disabled:l,placeholder:"250.00"}),g.cost&&(0,s.jsx)(h.bZ,{variant:"destructive",children:(0,s.jsx)(h.X,{children:g.cost.message})})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(m._,{htmlFor:"supplier",children:"Fornecedor"}),(0,s.jsx)(u.I,{id:"supplier",...d("supplier"),disabled:l,placeholder:"Nome do fornecedor"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(m._,{htmlFor:"lot",children:"Lote"}),(0,s.jsx)(u.I,{id:"lot",...d("lot"),disabled:l,placeholder:"N\xfamero do lote"})]})]}),!o&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(m._,{htmlFor:"lowStockAlertAt_m",children:"Alerta de Estoque Baixo (m)"}),(0,s.jsx)(u.I,{id:"lowStockAlertAt_m",type:"number",step:"0.1",...d("lowStockAlertAt_m",{valueAsNumber:!0}),disabled:l,placeholder:"10.0"}),g.lowStockAlertAt_m&&(0,s.jsx)(h.bZ,{variant:"destructive",children:(0,s.jsx)(h.X,{children:g.lowStockAlertAt_m.message})})]}),(0,s.jsxs)("div",{className:"flex justify-end space-x-2 pt-4",children:[(0,s.jsx)(c.z,{type:"button",variant:"outline",onClick:a,disabled:l,children:"Cancelar"}),(0,s.jsxs)(c.z,{type:"submit",disabled:l,children:[l&&(0,s.jsx)(f.Z,{className:"mr-2 h-4 w-4 animate-spin"}),o?"Reabastecer":t?"Atualizar":"Criar"," Rolo"]})]})]})})]})}var g=r(5974),j=r(6110),b=r(7099),y=r(8356),N=r(9397),w=r(4794),_=r(3085);let k=(0,r(9205).Z)("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);var A=r(1731),R=r(5153);function Z(){let[e,t]=(0,a.useState)([]),[r,i]=(0,a.useState)([]),[n,d]=(0,a.useState)(!0),[u,m]=(0,a.useState)(null),[h,f]=(0,a.useState)(!1),[v,Z]=(0,a.useState)(!1),[S,E]=(0,a.useState)(!1),[C,q]=(0,a.useState)(null),[F,T]=(0,a.useState)(!1),[V,z]=(0,a.useState)("all"),{toast:M}=(0,R.pm)();(0,a.useEffect)(()=>{I()},[]);let I=async()=>{try{d(!0);let[e,r]=await Promise.all([A.JZ.getAll(),A.JZ.getLowStock()]);t(e),i(r)}catch(e){console.error("Error loading data:",e),M({title:"Erro",description:"Erro ao carregar dados do estoque",variant:"destructive"})}finally{d(!1)}},O=async e=>{try{T(!0),u?(await A.JZ.update(u.id,e),M({title:"Sucesso",description:"Rolo atualizado com sucesso"})):(await A.JZ.create(e),M({title:"Sucesso",description:"Rolo adicionado ao estoque"})),await I(),f(!1),m(null)}catch(e){console.error("Error saving roll:",e),M({title:"Erro",description:"Erro ao salvar rolo",variant:"destructive"})}finally{T(!1)}},P=async e=>{if(u)try{T(!0),await A.JZ.restockRoll(u.id,e.length_m_total,"Reabastecimento: +".concat(e.length_m_total,"m")),M({title:"Sucesso",description:"Rolo reabastecido com ".concat(e.length_m_total,"m")}),await I(),Z(!1),m(null)}catch(e){console.error("Error restocking roll:",e),M({title:"Erro",description:"Erro ao reabastecer rolo",variant:"destructive"})}finally{T(!1)}},D=async()=>{if(C)try{await A.JZ.delete(C.id),M({title:"Sucesso",description:"Rolo exclu\xeddo do estoque"}),await I()}catch(e){console.error("Error deleting roll:",e),M({title:"Erro",description:"Erro ao excluir rolo",variant:"destructive"})}finally{E(!1),q(null)}},L=e=>{let t=e.lowStockAlertAt_m||10,r=e.length_m_available/e.length_m_total*100;return e.length_m_available<=t?{status:"low",color:"destructive",label:"Estoque Baixo"}:r<=25?{status:"warning",color:"secondary",label:"Aten\xe7\xe3o"}:{status:"good",color:"secondary",label:"OK"}},B=e.reduce((e,t)=>e+(t.cost||0),0),J=e.reduce((e,t)=>e+t.length_m_available,0);return(0,s.jsx)(l.L,{requiredRoles:["admin","atendente"],children:(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Estoque"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Gerencie rolos e tonalidades"})]}),(0,s.jsxs)(c.z,{onClick:()=>f(!0),children:[(0,s.jsx)(N.Z,{className:"h-4 w-4 mr-2"}),"Novo Rolo"]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,s.jsxs)(x.Zb,{children:[(0,s.jsxs)(x.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,s.jsx)(x.ll,{className:"text-sm font-medium",children:"Total de Rolos"}),(0,s.jsx)(w.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,s.jsx)(x.aY,{children:(0,s.jsx)("div",{className:"text-2xl font-bold",children:e.length})})]}),(0,s.jsxs)(x.Zb,{children:[(0,s.jsxs)(x.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,s.jsx)(x.ll,{className:"text-sm font-medium",children:"Metros Dispon\xedveis"}),(0,s.jsx)(_.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,s.jsx)(x.aY,{children:(0,s.jsxs)("div",{className:"text-2xl font-bold",children:[J.toFixed(1),"m"]})})]}),(0,s.jsxs)(x.Zb,{children:[(0,s.jsxs)(x.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,s.jsx)(x.ll,{className:"text-sm font-medium",children:"Valor em Estoque"}),(0,s.jsx)(w.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,s.jsx)(x.aY,{children:(0,s.jsxs)("div",{className:"text-2xl font-bold",children:["R$ ",B.toFixed(2)]})})]}),(0,s.jsxs)(x.Zb,{children:[(0,s.jsxs)(x.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,s.jsx)(x.ll,{className:"text-sm font-medium",children:"Estoque Baixo"}),(0,s.jsx)(k,{className:"h-4 w-4 text-destructive"})]}),(0,s.jsx)(x.aY,{children:(0,s.jsx)("div",{className:"text-2xl font-bold text-destructive",children:r.length})})]})]}),r.length>0&&(0,s.jsx)(x.Zb,{className:"border-destructive",children:(0,s.jsxs)(x.Ol,{children:[(0,s.jsxs)(x.ll,{className:"flex items-center text-destructive",children:[(0,s.jsx)(k,{className:"h-5 w-5 mr-2"}),"Alerta de Estoque Baixo"]}),(0,s.jsxs)(x.SZ,{children:[r.length," ",1===r.length?"rolo precisa":"rolos precisam"," ser reabastecidos"]})]})}),(0,s.jsxs)(y.mQ,{value:V,onValueChange:z,className:"space-y-4",children:[(0,s.jsxs)(y.dr,{children:[(0,s.jsx)(y.SP,{value:"all",children:"Todos"}),(0,s.jsx)(y.SP,{value:"available",children:"Dispon\xedveis"}),(0,s.jsx)(y.SP,{value:"low-stock",children:"Estoque Baixo"}),(0,s.jsx)(y.SP,{value:"empty",children:"Esgotados"})]}),(0,s.jsx)(y.nU,{value:V,children:(0,s.jsx)(o.w,{data:(()=>{switch(V){case"low-stock":return r;case"available":return e.filter(e=>e.length_m_available>0);case"empty":return e.filter(e=>0===e.length_m_available);default:return e}})(),columns:[{key:"tone",title:"Tonalidade",sortable:!0},{key:"width_mm",title:"Largura",render:e=>"".concat(e,"mm")},{key:"stock",title:"Estoque",render:(e,t)=>(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsxs)("div",{className:"text-sm",children:[(0,s.jsxs)("span",{className:"font-medium",children:[t.length_m_available.toFixed(1),"m"]}),(0,s.jsxs)("span",{className:"text-muted-foreground",children:[" / ",t.length_m_total.toFixed(1),"m"]})]}),(0,s.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,s.jsx)("div",{className:"bg-primary h-2 rounded-full",style:{width:"".concat(Math.min(100,t.length_m_available/t.length_m_total*100),"%")}})})]})},{key:"status",title:"Status",render:(e,t)=>{let r=L(t);return(0,s.jsx)(g.C,{variant:r.color,children:r.label})}},{key:"cost",title:"Custo",render:e=>e?"R$ ".concat(e.toFixed(2)):"-"},{key:"supplier",title:"Fornecedor",render:e=>e||"-"},{key:"lot",title:"Lote",render:e=>e||"-"}],title:"Rolos em Estoque",description:"Controle de tonalidades e quantidades",searchPlaceholder:"Buscar por tonalidade, fornecedor ou lote...",onAdd:()=>f(!0),onEdit:e=>{m(e),f(!0)},onDelete:e=>{q(e),E(!0)},onView:e=>{m(e),Z(!0)},loading:n,addButtonText:"Novo Rolo"})})]}),(0,s.jsx)(j.Vq,{open:h,onOpenChange:f,children:(0,s.jsx)(j.cZ,{className:"max-w-2xl",children:(0,s.jsx)(p,{roll:u||void 0,onSubmit:O,onCancel:()=>{f(!1),m(null)},loading:F})})}),(0,s.jsx)(j.Vq,{open:v,onOpenChange:Z,children:(0,s.jsx)(j.cZ,{className:"max-w-2xl",children:(0,s.jsx)(p,{roll:u||void 0,onSubmit:P,onCancel:()=>{Z(!1),m(null)},loading:F,isRestock:!0})})}),(0,s.jsx)(b.aR,{open:S,onOpenChange:E,children:(0,s.jsxs)(b._T,{children:[(0,s.jsxs)(b.fY,{children:[(0,s.jsx)(b.f$,{children:"Confirmar Exclus\xe3o"}),(0,s.jsx)(b.yT,{children:"Tem certeza que deseja excluir este rolo do estoque? Esta a\xe7\xe3o n\xe3o pode ser desfeita."})]}),(0,s.jsxs)(b.xo,{children:[(0,s.jsx)(b.le,{children:"Cancelar"}),(0,s.jsx)(b.OL,{onClick:D,className:"bg-destructive text-destructive-foreground",children:"Excluir"})]})]})})]})})}},5613:function(e,t,r){"use strict";r.d(t,{X:function(){return d},bZ:function(){return n}});var s=r(7437),a=r(2265),l=r(535),o=r(4508);let i=(0,l.j)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),n=a.forwardRef((e,t)=>{let{className:r,variant:a,...l}=e;return(0,s.jsx)("div",{ref:t,role:"alert",className:(0,o.cn)(i({variant:a}),r),...l})});n.displayName="Alert",a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("h5",{ref:t,className:(0,o.cn)("mb-1 font-medium leading-none tracking-tight",r),...a})}).displayName="AlertTitle";let d=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,o.cn)("text-sm [&_p]:leading-relaxed",r),...a})});d.displayName="AlertDescription"},5974:function(e,t,r){"use strict";r.d(t,{C:function(){return i}});var s=r(7437);r(2265);var a=r(535),l=r(4508);let o=(0,a.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function i(e){let{className:t,variant:r,...a}=e;return(0,s.jsx)("div",{className:(0,l.cn)(o({variant:r}),t),...a})}},8356:function(e,t,r){"use strict";r.d(t,{mQ:function(){return S},nU:function(){return q},dr:function(){return E},SP:function(){return C}});var s=r(7437),a=r(2265),l=r(6741),o=r(3966),i=r(1353),n=r(1599),d=r(6840),c=r(9114),u=r(886),m=r(9255),x="Tabs",[h,f]=(0,o.b)(x,[i.Pc]),v=(0,i.Pc)(),[p,g]=h(x),j=a.forwardRef((e,t)=>{let{__scopeTabs:r,value:a,onValueChange:l,defaultValue:o,orientation:i="horizontal",dir:n,activationMode:x="automatic",...h}=e,f=(0,c.gm)(n),[v,g]=(0,u.T)({prop:a,onChange:l,defaultProp:o});return(0,s.jsx)(p,{scope:r,baseId:(0,m.M)(),value:v,onValueChange:g,orientation:i,dir:f,activationMode:x,children:(0,s.jsx)(d.WV.div,{dir:f,"data-orientation":i,...h,ref:t})})});j.displayName=x;var b="TabsList",y=a.forwardRef((e,t)=>{let{__scopeTabs:r,loop:a=!0,...l}=e,o=g(b,r),n=v(r);return(0,s.jsx)(i.fC,{asChild:!0,...n,orientation:o.orientation,dir:o.dir,loop:a,children:(0,s.jsx)(d.WV.div,{role:"tablist","aria-orientation":o.orientation,...l,ref:t})})});y.displayName=b;var N="TabsTrigger",w=a.forwardRef((e,t)=>{let{__scopeTabs:r,value:a,disabled:o=!1,...n}=e,c=g(N,r),u=v(r),m=A(c.baseId,a),x=R(c.baseId,a),h=a===c.value;return(0,s.jsx)(i.ck,{asChild:!0,...u,focusable:!o,active:h,children:(0,s.jsx)(d.WV.button,{type:"button",role:"tab","aria-selected":h,"aria-controls":x,"data-state":h?"active":"inactive","data-disabled":o?"":void 0,disabled:o,id:m,...n,ref:t,onMouseDown:(0,l.M)(e.onMouseDown,e=>{o||0!==e.button||!1!==e.ctrlKey?e.preventDefault():c.onValueChange(a)}),onKeyDown:(0,l.M)(e.onKeyDown,e=>{[" ","Enter"].includes(e.key)&&c.onValueChange(a)}),onFocus:(0,l.M)(e.onFocus,()=>{let e="manual"!==c.activationMode;h||o||!e||c.onValueChange(a)})})})});w.displayName=N;var _="TabsContent",k=a.forwardRef((e,t)=>{let{__scopeTabs:r,value:l,forceMount:o,children:i,...c}=e,u=g(_,r),m=A(u.baseId,l),x=R(u.baseId,l),h=l===u.value,f=a.useRef(h);return a.useEffect(()=>{let e=requestAnimationFrame(()=>f.current=!1);return()=>cancelAnimationFrame(e)},[]),(0,s.jsx)(n.z,{present:o||h,children:r=>{let{present:a}=r;return(0,s.jsx)(d.WV.div,{"data-state":h?"active":"inactive","data-orientation":u.orientation,role:"tabpanel","aria-labelledby":m,hidden:!a,id:x,tabIndex:0,...c,ref:t,style:{...e.style,animationDuration:f.current?"0s":void 0},children:a&&i})}})});function A(e,t){return"".concat(e,"-trigger-").concat(t)}function R(e,t){return"".concat(e,"-content-").concat(t)}k.displayName=_;var Z=r(4508);let S=j,E=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)(y,{ref:t,className:(0,Z.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",r),...a})});E.displayName=y.displayName;let C=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)(w,{ref:t,className:(0,Z.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",r),...a})});C.displayName=w.displayName;let q=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)(k,{ref:t,className:(0,Z.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",r),...a})});q.displayName=k.displayName},1817:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(9205).Z)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},9397:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(9205).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},3085:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(9205).Z)("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]])}},function(e){e.O(0,[609,15,365,852,905,593,641,302,971,117,744],function(){return e(e.s=3768)}),_N_E=e.O()}]);